rules:
  - id: fdc1cdcb8675476c8f5fc63daf7e8e8e
    name: SuperAdmins rule
    description: General rule for super admins
    # target: any action from User within Organization resource
    condition: "subject.user.role_associations.find((association) => {
        return association.role == '78c2571c1bf8483285ca61633a24a451'
      }) != null"
    effect: PERMIT
  - id: 5c737288c919427599f301b4a05d23db
    name: Read rule
    description: Allow 'read' action to admin or normal user
    effect: PERMIT
  - id: 426a9674a1cc4ce290b3dafd5fc3e58c
    name: General rule
    description: Allow everything to admin
    condition: "subject.user.role_associations.find((association) => {
      if (association.role != 'dfcfe667eb614cc1864b3c723297240a') {
        return false;
      }
      return association.attributes.find((attribute) => {
        if (attribute.id == 'urn:oasis:names:tc:xacml:1.0:resource:resource-id'
          && attribute.value == resources.organization.id) {
            return true;
          }
        }) != null;
      }) != null;"
    effect: PERMIT
  - id: c0c58cda968b4211af31d4278c5ae27c
    name: Fallback rule
    description: Deny-all
    effect: DENY
